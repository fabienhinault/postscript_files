%!PS
%%DocumentMedia: a4 842 595 80 () ()

/rawPageHeight 595 def
/rawPageWidth 842 def

<< /PageSize [rawPageWidth rawPageHeight] >> setpagedevice

/mm { 2.834645669 mul } def

/margin 10 mm def


/Courier findfont               % load the font, for instance, Courier
0 dict copy begin               % copy it to a new dictionary
/Encoding ISOLatin1Encoding def % replace encoding vector
/MyCourier /FontName def        % replace font name
currentdict end
dup /FID undef                  % remove internal data
/MyCourier exch definefont pop  % define the new font 

/Helvetica findfont               % load the font, for instance, Courier
0 dict copy begin               % copy it to a new dictionary
/Encoding ISOLatin1Encoding def % replace encoding vector
/MyHelvetica /FontName def        % replace font name
currentdict end
dup /FID undef                  % remove internal data
/MyHelvetica exch definefont pop  % define the new font 

% 1cm at left for hours
/pageWidth rawPageWidth margin 3 mul sub def
/pageHeight rawPageHeight margin 2 mul sub def

/nbCol 5 def
/colWidth pageWidth nbCol div def

%vertical lines
% args: xmin ymin xmax ymax nbLines
/drawVerticalLines {
  /nbLines exch def
  /ymax exch def
  /xmax exch def
  /ymin exch def
  /xmin exch def
  /dxtotal xmax xmin sub def
  /dytotal ymax ymin sub def
  /dx dxtotal nbLines 1 sub div def
  /iVertLine 0 def
  nbLines
  {
    newpath
    xmin iVertLine dx mul add ymin moveto
    0 dytotal rlineto
    stroke
    iVertLine 1 add
    /iVertLine exch def
  } repeat
} def
margin 2 mul
margin
rawPageWidth margin sub
rawPageHeight margin sub
6
drawVerticalLines
%horizontal lines
% args: xmin ymin xmax ymax nbLines
/nbRow 9 def
/rowHeight pageHeight nbRow div def
/drawHorizontalLines {
  /nbLines exch def
  /ymax exch def
  /xmax exch def
  /ymin exch def
  /xmin exch def
  /dxtotal xmax xmin sub def
  /dytotal ymax ymin sub def
  /dy dytotal nbLines 1 sub div def
  /iHorizLine 0 def
  nbLines
  {
    newpath
    xmin
    ymin iHorizLine dy mul add
    moveto
    dxtotal 0 rlineto
    stroke
    iHorizLine 1 add
    /iHorizLine exch def
  } repeat
} def
margin 2 mul
margin
rawPageWidth margin sub
rawPageHeight margin sub
10
drawHorizontalLines


/pageWidthHalf pageWidth 0.5 mul def

% arg stack: y x_right x_left  string 
% prints the string at y, centered between x_left and x_right
/centerText {
	dup % arg stack: y x_right x_left  string string
	/Text % arg stack: y x_right x_left  string string /Text
	exch % arg stack: y x_right x_left  string /Text string 
	def % arg stack: y x_right x_left  string  
	stringwidth % arg stack: y x_right x_left  dx (dy=0) 
	pop % arg stack: y x_right x_left  dx  
	2 % arg stack: y x_right x_left  dx 2 
	div % arg stack: y x_right x_left  dx/2 
	/HalfWidth % arg stack: y x_right x_left  dx/2 /HalfWidth 
	exch % arg stack: y x_right x_left  /HalfWidth dx/2  
	def % arg stack: y x_right x_left  
	dup % arg stack: y x_right x_left x_left 
	/Left % arg stack: y x_right x_left  x_left /Left 
	exch % arg stack: y x_right x_left /Left  x_left 
	def % arg stack: y x_right x_left 
	sub % arg stack: y (x_left - x_right)
	2 % arg stack: y (x_left - x_right) 2
	div % arg stack: y (x_left - x_right)/2
	HalfWidth % arg stack: y (x_left - x_right)/2 HalfWith
	sub % arg stack: y ((x_left - x_right)/2 - HalfWith)
	Left % arg stack: y ((x_left - x_right)/2 - HalfWith) x_left
	add % arg stack: y ((x_left - x_right)/2 - HalfWith)+x_left
	exch
	newpath
	moveto
	Text
	show
} def

% arg stack: string iCol iRow xmin ymin dx dy fontSize
/placeText {
  /fontSize exch def
  /dy exch def
  /dx exch def 
  /ymin exch def
  /xmin exch def
  % arg stack: string iCol iRow 
  0.5 add dy mul ymin add
  fontSize 4 div sub % empiric value
  /y exch def
  dup dx mul xmin add /x_right exch def
  1 add dx mul xmin add /x_left exch def
  /text exch def
  y x_right x_left text centerText
} def

%(Toto) 0 0 2 margin mul margin pageWidth nbCol div pageHeight nbRow div 20 placeText

% arg stack: 2*nbRows hours to place, followed by xmin ymin dy nRows fontSize
/placeHours {
  /fontSize exch def
  /nRows exch def
  /dy exch def
  /ymin exch def
  /xmin exch def
  (00:00)
  stringwidth pop
  xmin
  exch
  sub
  2
  sub
  /x exch def
  /ybottom ymin def
  nRows {
    /hourBottom exch def
    /hourTop exch def
    ybottom
    dup
    2 add x exch newpath moveto hourBottom show    
    x exch dy add 1 add fontSize sub newpath moveto hourTop show    
    /ybottom ybottom dy add def
  } repeat
} def
/placeGlobalHours {
  (00:00)
  stringwidth pop
  margin 2 mul 
  exch
  sub
  2
  sub
  /x exch def
  /iRow 0 def
  nbRow {
    /hourBottom exch def
    /hourTop exch def
    margin rowHeight iRow mul add
    dup
    2 add x exch newpath moveto hourBottom show    
    x exch rowHeight add 12 sub newpath moveto hourTop show    
    /iRow iRow 1 add def
  } repeat
} def

/MyHelvetica findfont 13 scalefont setfont

()
()
(08:25)
(09:20)
(09:23)
(10:18)
(10:33)
(10:28)
(11:35)
(12:30)
()
()
(14:00)
(14:55)
(14:58)
(15:53)
(16:10)
(17:05)
2 margin mul
margin
pageHeight nbRow div
nbRow
13
placeHours
%placeGlobalHours

% arg stack: all strings in columns iRow, iCol = 0,0 , 1,0 , ... , nRow-1,0 , 1,0, ...
% 0,0 first in stack, nRow-1,nCol-1 last
/fillTable {
  /dx pageWidth nbCol div def
  /dy pageHeight nbRow div def
  /iCol nbCol 1 sub def
  /iRow 0 def
  nbCol
  {
     nbRow 
     {
       iCol iRow 2 margin mul margin dx dy 20 placeText %eats 1 string in stack
       /iRow iRow 1 add def
     } repeat
     /iRow 0 def
     /iCol iCol 1 sub def
  } repeat
} def

/math (Math\351matiques) def 
/hg (Histoire G\351o) def
/fran (Fran\347ais) def
/apfran (AP Fran\347ais) def

/MyHelvetica findfont 20 scalefont setfont

(LUNDI)
()
(Arts plastiques)
(Allemand)
(Musique)
()
(Anglais)
fran
hg

(MARDI)
([Vie de classe])
(Technologie)
math
(Anglais)
()
(EPS)
fran
(Projet info num)

(MERCREDI)
hg
fran
(SVT)
()
()
()
()
()

(JEUDI)
(Latin)
(Anglais)
math
(Allemand)
()
fran
hg
()

(VENDREDI)
(Latin)
(Physique Chimie)
math
fran
()
(EPS)
(EPS)
(Allemand)
fillTable

showpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%(Toto) 0 0 2 margin mul margin pageWidth nbCol div pageHeight nbRow div 20 placeText

margin 2 mul
margin
rawPageWidth margin sub
rawPageHeight margin sub
6
drawVerticalLines
%drawGlobalVerticalLines
margin 2 mul
margin
rawPageWidth margin sub
rawPageHeight margin sub
10
drawHorizontalLines
%drawGlobalHorizontalLines

/MyHelvetica findfont 13 scalefont setfont


()
()
(08:25)
(09:20)
(09:23)
(10:18)
(10:33)
(10:28)
(11:35)
(12:30)
()
()
(14:00)
(14:55)
(14:58)
(15:53)
(16:10)
(17:05)
2 margin mul
margin
pageHeight nbRow div
nbRow
13
placeHours

/MyHelvetica findfont 20 scalefont setfont

(LUNDI)
(Technologie)
(Arts plastiques)
math
(Musique)
()
(Anglais)
(SVT)
hg

(MARDI)
(Physique Chimie)
(Technologie)
math
(Anglais)
()
(EPS)
fran
()

(MERCREDI)
hg
fran
(SVT)
()
()
()
()
()

(JEUDI)
(Latin)
(Anglais)
math
(Allemand)
()
fran
hg
()

(VENDREDI)
(Latin)
(Physique Chimie)
math
fran
()
(EPS)
(EPS)
(Allemand)
fillTable
 
showpage
